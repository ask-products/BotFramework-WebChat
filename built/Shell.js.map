{"version":3,"file":"Shell.js","sourceRoot":"","sources":["../src/Shell.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { ChatState, FormatState } from './Store';\nimport { User } from 'botframework-directlinejs';\nimport { classList } from './Chat';\nimport { Dispatch, connect } from 'react-redux';\nimport { Strings } from './Strings';\nimport { Speech } from './SpeechModule'\nimport { ChatActions, ListeningState, sendMessage, sendFiles, apSendFiles, UiState, setUploadState } from './Store';\n\n\n// ASKPRO\nimport { apUriFromFiles } from './ask_pro/file_upload';\nimport { AttachmentView } from './Attachment';\n// END ASKPRO\n\ninterface Props {\n    inputText: string,\n    strings: Strings,\n    listeningState: ListeningState,\n    showUploadButton: boolean,\n\n    apUi: UiState,\n    disableInput: () => void,\n    enableInput: () => void,\n    \n\n    onChangeText: (inputText: string) => void,\n\n    sendMessage: (inputText: string) => void,\n    sendFiles: (files: FileList) => void,\n    apSendFiles: (attachment: any) => void,\n    setUploadState: (state: any) => void,\n    setUploadFiles: (files: string[]) => void,\n    setErrorFiles: (files: string[]) => void,\n    stopListening: () => void,\n    startListening: () => void\n}\n\nexport interface ShellFunctions {\n    focus: (appendKey?: string) => void\n}\n\nclass ShellContainer extends React.Component<Props> implements ShellFunctions {\n    private textInput: HTMLInputElement;\n    private fileInput: HTMLInputElement;\n\n    private sendMessage() {\n        if (this.props.inputText.trim().length > 0) {\n            this.props.disableInput();\n            this.props.sendMessage(this.props.inputText);\n        }\n    }\n    \n    private handleSendButtonKeyPress(evt: React.KeyboardEvent<HTMLButtonElement>) {\n        if (evt.key === 'Enter' || evt.key === ' ') {\n            evt.preventDefault();\n            this.sendMessage();\n            this.textInput.focus();\n        }\n    }\n    \n    private handleUploadButtonKeyPress(evt: React.KeyboardEvent<HTMLLabelElement>) {\n        if (evt.key === 'Enter' || evt.key === ' ') {\n            evt.preventDefault();\n            this.fileInput.click();\n        }\n    }\n    \n    private onKeyPress(e: React.KeyboardEvent<HTMLInputElement>) {\n        if (e.key === 'Enter') {\n            this.sendMessage();\n        }\n    }\n    \n    private onClickSend() {\n        this.sendMessage();\n    }\n    private addPendingFiles(value: string) {\n        let newpending = this.props.apUi.pendingUploads.slice(0);\n        newpending.push(value);\n        this.props.setUploadFiles(newpending);\n    }\n    private removePendingFiles(value: string) {\n        let newpending = this.props.apUi.pendingUploads.filter( (file: string) => {return file !== value} ); \n        this.props.setUploadFiles(newpending);\n    }\n    private addErrorFiles(value: string) {\n        let newerrors = this.props.apUi.erroredUploads.slice(0);\n        newerrors.push(value);\n        this.props.setErrorFiles(newerrors);\n    }\n    private removeErrorFiles(value: string) {\n        let newerror = this.props.apUi.erroredUploads.filter( (file: string) => {return file !== value} ); \n        this.props.setErrorFiles(newerror);\n    }\n    private onChangeFile() {\n        // set state variable holding valueas for pending upload files.\n        const fileData = apUriFromFiles(this.fileInput.files);\n        const calls = fileData[0];\n        for(let file of fileData[1]){\n            this.addPendingFiles(file);\n        }\n        this.props.setUploadState('UPLOADING');\n        for(let call of calls){\n            const attachment = [call];\n            call.then((value: any) => {\n                this.props.apSendFiles([value]);\n                this.removePendingFiles(value.name);\n                // if all pending files are finished\n                if(this.props.apUi.pendingUploads.length === 0) {                \n                    this.props.setUploadState('DEFAULT');\n                }\n                // reset Ui\n                this.fileInput.value = null;\n                this.textInput.focus();\n            })\n            .catch((err: any) => {\n                this.removePendingFiles(err.file);\n                this.addErrorFiles(err.file);\n                // this.props.setUploadState('ERROR'); // this is disabled while we dicide on how to relay the fail info to the user.\n            });\n        }\n    }\n    \n    private onTextInputFocus(){\n        if (this.props.listeningState === ListeningState.STARTED) {\n            this.props.stopListening();\n        }\n    }\n\n    private onClickMic() {\n        if (this.props.listeningState === ListeningState.STARTED) {\n            this.props.stopListening();\n        } else if (this.props.listeningState === ListeningState.STOPPED) {\n            this.props.startListening();\n        }\n    }\n\n    public focus(appendKey?: string) {\n        this.textInput.focus();\n\n        if (appendKey) {\n            this.props.onChangeText(this.props.inputText + appendKey);\n        }\n    }\n    private fileIcon(state: string){\n        switch(state){\n            case 'UPLOADING':\n                return (\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n                        <path d=\"M412.6 227.1L278.6 89c-5.8-6-13.7-9-22.4-9h-.4c-8.7 0-16.6 3-22.4 9l-134 138.1c-12.5 12-12.5 31.3 0 43.2 12.5 11.9 32.7 11.9 45.2 0l79.4-83v214c0 16.9 14.3 30.6 32 30.6 18 0 32-13.7 32-30.6v-214l79.4 83c12.5 11.9 32.7 11.9 45.2 0s12.5-31.2 0-43.2z\"/>\n                    </svg>\n                );\n            // case 'ERROR':\n            //     return (\n            //         <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n            //             <path d=\"M278.6 256l68.2-68.2c6.2-6.2 6.2-16.4 0-22.6-6.2-6.2-16.4-6.2-22.6 0L256 233.4l-68.2-68.2c-6.2-6.2-16.4-6.2-22.6 0-3.1 3.1-4.7 7.2-4.7 11.3 0 4.1 1.6 8.2 4.7 11.3l68.2 68.2-68.2 68.2c-3.1 3.1-4.7 7.2-4.7 11.3 0 4.1 1.6 8.2 4.7 11.3 6.2 6.2 16.4 6.2 22.6 0l68.2-68.2 68.2 68.2c6.2 6.2 16.4 6.2 22.6 0 6.2-6.2 6.2-16.4 0-22.6L278.6 256z\"/>\n            //         </svg>\n            //     );\n            default:\n                return(\n                    <svg>\n                        <path d=\"M17.1739993,7.70416151 C19.4161161,5.52059528 23.0822691,5.52059528 25.3243331,7.70410998 C27.7184735,10.0341339 27.4282212,13.5644568 25.3243597,15.6098095 L15.6287879,25.048979 L14.6758693,24.1216236 L14.8354747,23.9669607 L24.3842707,14.7139495 C25.9787245,13.241131 26.215502,10.4556717 24.3800429,8.59166733 C22.6755457,6.92968323 19.8228395,6.92968323 18.1182195,8.591787 L7.28700007,19.1360817 C5.99581012,20.3932153 5.99581012,22.3963603 7.28700007,23.6090772 C8.58142055,24.8693561 10.6481765,24.8693561 11.8975833,23.6086611 L21.1690052,14.63163 C21.9542576,13.8660587 21.9542576,12.5770803 21.1690052,11.8115091 C20.3806892,11.0429512 19.0476,11.0429512 18.2591652,11.8116248 L10.0744157,19.7789766 L9.12191043,18.8520235 L9.28071807,18.6973492 L17.3103469,10.8767105 C18.6319247,9.58632427 20.787555,9.58632427 22.1091328,10.8767105 C23.4335913,12.1699093 23.4335913,14.2732298 22.1089295,15.5666269 L12.8414124,24.5916211 C10.820263,26.5607117 7.91585521,26.1828043 6.30219937,24.5949593 C4.59286478,23.0027813 4.5113578,19.9590317 6.34441985,18.2468596 L17.1739993,7.70416151 Z\" id=\"Shape\"></path>\n                    </svg>\n                );\n            }\n        }\n        \n        private uploadBadge(count: number, type: string){\n            let col = \"#EEE\";\n            if(type === 'error'){\n                col = \"#ffccd3\"\n            }\n            return (\n                <svg xmlns=\"http://www.w3.org/2000/svg\" style={{\"position\":\"absolute\", \"top\":\"22px\"}} className={'upload-indicator'}>\n                    <ellipse cx=\"8\" cy=\"8\" rx=\"8\" ry=\"8\" fill={col}/>\n                    <text x=\"4\" y=\"13\" width=\"8\" height=\"8\" color=\"%23000\" fontSize=\"small\">{count}</text>\n                </svg>\n            );\n        }\n    render() {\n        const className = classList(\n            'wc-console',\n            this.props.inputText.length > 0 && 'has-text',\n            this.props.showUploadButton && 'has-upload-button'\n        );\n\n        const showMicButton = this.props.listeningState !== ListeningState.STOPPED || (Speech.SpeechRecognizer.speechIsAvailable()  && !this.props.inputText.length);\n\n        const sendButtonClassName = classList(\n            'wc-send',\n            showMicButton && 'hidden'\n        );\n\n        const micButtonClassName = classList(\n            'wc-mic',\n            !showMicButton && 'hidden',\n            this.props.listeningState === ListeningState.STARTED && 'active',\n            this.props.listeningState !== ListeningState.STARTED && 'inactive'\n        );\n\n        const placeholder = this.props.listeningState === ListeningState.STARTED ? this.props.strings.listeningIndicator : this.props.strings.consolePlaceholder;\n\n        return (\n            <div className={ className }>\n             {this.props.apUi.pendingUploads.length > 0 && this.uploadBadge(this.props.apUi.pendingUploads.length, 'upload')}\n             {/* {this.props.apUi.erroredUploads.length > 0 && this.uploadBadge(this.props.apUi.erroredUploads.length, 'error')} */}\n             {/* {true && this.uploadBadge(this.props.apUi.pendingUploads.length)} */}\n                {\n                    this.props.showUploadButton &&\n                        <label\n                            className=\"wc-upload\"\n                            htmlFor=\"wc-upload-input\"\n                            onKeyPress={ evt => this.handleUploadButtonKeyPress(evt) }\n                            tabIndex={ 0 }\n                        >\n                            {this.fileIcon(this.props.apUi.uploadState)} \n                        </label>\n                }\n                {\n                    this.props.showUploadButton &&\n                        <input\n                            id=\"wc-upload-input\"\n                            tabIndex={ -1 }\n                            type=\"file\"\n                            ref={ input => this.fileInput = input }\n                            multiple\n                            onChange={ () => this.onChangeFile() }\n                            aria-label={ this.props.strings.uploadFile }\n                            role=\"button\"\n                            disabled= {!this.props.apUi.inputState}\n                        />\n                }\n                <div className=\"wc-textbox\">\n                    <input\n                        type=\"text\"\n                        className=\"wc-shellinput\"\n                        ref={ input => this.textInput = input }\n                        autoFocus\n                        value={ this.props.inputText }\n                        onChange={ _ => this.props.onChangeText(this.textInput.value) }\n                        onKeyPress={ e => this.onKeyPress(e) }\n                        onFocus={ () => this.onTextInputFocus() }\n                        placeholder={ placeholder }\n                        aria-label={ this.props.inputText ? null : placeholder }\n                        aria-live=\"polite\"\n                        disabled= {!this.props.apUi.inputState}\n                    />\n                </div>\n                <button\n                    className={ sendButtonClassName }\n                    onClick={ () => this.onClickSend() }\n                    aria-label={ this.props.strings.send }\n                    role=\"button\"\n                    onKeyPress={ evt => this.handleSendButtonKeyPress(evt) }\n                    tabIndex={ 0 }\n                    type=\"button\"\n                    disabled= {!this.props.apUi.inputState}\n                >\n                    {/* <svg>\n                        <path d=\"M26.79 9.38A0.31 0.31 0 0 0 26.79 8.79L0.41 0.02C0.36 0 0.34 0 0.32 0 0.14 0 0 0.13 0 0.29 0 0.33 0.01 0.37 0.03 0.41L3.44 9.08 0.03 17.76A0.29 0.29 0 0 0 0.01 17.8 0.28 0.28 0 0 0 0.01 17.86C0.01 18.02 0.14 18.16 0.3 18.16A0.3 0.3 0 0 0 0.41 18.14L26.79 9.38ZM0.81 0.79L24.84 8.79 3.98 8.79 0.81 0.79ZM3.98 9.37L24.84 9.37 0.81 17.37 3.98 9.37Z\" />\n                    </svg> */}\n                    <svg>\n                        <polygon id=\"Combined-Shape\" points=\"5.01141071 6 5 14.1666484 22.1428571 16.5 5 18.8333516 5.01141071 27 29 16.5\"></polygon>\n                    </svg>\n                </button>\n                <button\n                    className={ micButtonClassName }\n                    onClick={ () => this.onClickMic() }\n                    aria-label={ this.props.strings.speak }\n                    role=\"button\"\n                    tabIndex={ 0 }\n                    type=\"button\"\n                    disabled= {!this.props.apUi.inputState}\n                >\n                   <svg width=\"28\" height=\"22\" viewBox=\"0 0 58 58\" >\n                        <path d=\"M 44 28 C 43.448 28 43 28.447 43 29 L 43 35 C 43 42.72 36.72 49 29 49 C 21.28 49 15 42.72 15 35 L 15 29 C 15 28.447 14.552 28 14 28 C 13.448 28 13 28.447 13 29 L 13 35 C 13 43.485 19.644 50.429 28 50.949 L 28 56 L 23 56 C 22.448 56 22 56.447 22 57 C 22 57.553 22.448 58 23 58 L 35 58 C 35.552 58 36 57.553 36 57 C 36 56.447 35.552 56 35 56 L 30 56 L 30 50.949 C 38.356 50.429 45 43.484 45 35 L 45 29 C 45 28.447 44.552 28 44 28 Z\"/>\n                        <path id=\"micFilling\" d=\"M 28.97 44.438 L 28.97 44.438 C 23.773 44.438 19.521 40.033 19.521 34.649 L 19.521 11.156 C 19.521 5.772 23.773 1.368 28.97 1.368 L 28.97 1.368 C 34.166 1.368 38.418 5.772 38.418 11.156 L 38.418 34.649 C 38.418 40.033 34.166 44.438 28.97 44.438 Z\"/>\n                        <path d=\"M 29 46 C 35.065 46 40 41.065 40 35 L 40 11 C 40 4.935 35.065 0 29 0 C 22.935 0 18 4.935 18 11 L 18 35 C 18 41.065 22.935 46 29 46 Z M 20 11 C 20 6.037 24.038 2 29 2 C 33.962 2 38 6.037 38 11 L 38 35 C 38 39.963 33.962 44 29 44 C 24.038 44 20 39.963 20 35 L 20 11 Z\"/>\n                    </svg>\n                </button>\n            </div>\n        );\n    }\n}\n\nexport const Shell = connect(\n    (state: ChatState) => ({\n        // passed down to ShellContainer\n        inputText: state.shell.input,\n        showUploadButton: state.format.showUploadButton,\n        strings: state.format.strings,\n        // only used to create helper functions below\n        locale: state.format.locale,\n        user: state.connection.user,\n        listeningState: state.shell.listeningState,\n        // ASK PRO\n        apUi: state.apUi\n    }), {\n        // passed down to ShellContainer\n        onChangeText: (input: string) => ({ type: 'Update_Input', input, source: \"text\" } as ChatActions),\n        stopListening:  () => ({ type: 'Listening_Stopping' }),\n        startListening:  () => ({ type: 'Listening_Starting' }),\n        disableInput:   () => ({ type: 'Set_Input_State', newState: false }),\n        enableInput:   () => ({ type: 'Set_Input_State', newState: true }),\n        setUploadFiles: (files: string[]) => ({ type: 'Set_Upload_Files', files: files}),\n        setErrorFiles: (files: string[]) => ({ type: 'Set_Error_Files', files: files}),\n        // only used to create helper functions below\n        sendMessage,\n        sendFiles,\n        apSendFiles,\n        setUploadState\n    }, (stateProps: any, dispatchProps: any, ownProps: any): Props => ({\n        // from stateProps\n        inputText: stateProps.inputText,\n        showUploadButton: stateProps.showUploadButton,\n        strings: stateProps.strings,\n        listeningState: stateProps.listeningState,\n        apUi: stateProps.apUi,\n        // from dispatchProps\n        onChangeText: dispatchProps.onChangeText,\n        // helper functions\n        sendMessage: (text: string) => dispatchProps.sendMessage(text, stateProps.user, stateProps.locale),\n        sendFiles: (files: FileList) => dispatchProps.sendFiles(files, stateProps.user, stateProps.locale),\n        setUploadState: (state: any) => dispatchProps.setUploadState(state),\n        setUploadFiles: (files: string[]) => dispatchProps.setUploadFiles(files),\n        setErrorFiles: (files: string[]) => dispatchProps.setErrorFiles(files),\n        startListening: () => dispatchProps.startListening(),\n        stopListening: () => dispatchProps.stopListening(),\n        // ASK PRO\n        apSendFiles: (attachment: any) => dispatchProps.apSendFiles(attachment, stateProps.user, stateProps.locale),\n        disableInput: () => dispatchProps.disableInput(),\n        enableInput: () => dispatchProps.disableInput()\n\n    }), {\n        withRef: true\n    }\n)(ShellContainer);\n"]}